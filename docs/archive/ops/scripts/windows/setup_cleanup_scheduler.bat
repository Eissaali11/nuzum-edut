@echo off
REM Windows Task Scheduler setup script for Auto-Cleanup
REM
REM ูุฐุง ุงูุณูุฑูุจุช ููุดุฆ ูููุฉ ูุฌุฏููุฉ ูู Windows ูุชุดุบูู auto_cleanup.py ููููุงู
REM 
REM ุงูุงุณุชุฎุฏุงู:
REM setup_cleanup_scheduler.bat

REM ุชุดุบูู ูู Administrator
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo. 
    echo โ ูุฐุง ุงูุณูุฑูุจุช ูุชุทูุจ ุตูุงุญูุงุช Administrator
    echo. 
    echo ุงูุฑุฌุงุก ุชุดุบูู Command Prompt ููุณุคูู ุซู ุฌุงุฑู ูุฐุง ุงูููู
    pause
    exit /b 1
)

setlocal enabledelayedexpansion

REM ุชุญุฏูุฏ ุงููุชุบูุฑุงุช
set PYTHON_PATH=d:\nuzm\venv\Scripts\python.exe
set SCRIPT_PATH=d:\nuzm\auto_cleanup.py
set TASK_NAME=NuzumHR_AutoCleanup
set SCHEDULE_TIME=02:00

REM ุงูุชุญูู ูู ูุฌูุฏ Python
if not exist "%PYTHON_PATH%" (
    echo โ ูู ูุชู ุงูุนุซูุฑ ุนูู Python ูู ุงููุณุงุฑ ุงููุชููุน
    echo ุงููุณุงุฑ ุงููุชููุน: %PYTHON_PATH%
    pause
    exit /b 1
)

REM ุงูุชุญูู ูู ูุฌูุฏ ุงูุณูุฑูุจุช
if not exist "%SCRIPT_PATH%" (
    echo โ ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุณูุฑูุจุช ูู ุงููุณุงุฑ ุงููุชููุน
    echo ุงููุณุงุฑ ุงููุชููุน: %SCRIPT_PATH%
    pause
    exit /b 1
)

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo  ๐ง ุฅุนุฏุงุฏ ุฌุฏููุฉ Auto-Cleanup ูู Nuzum HR
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

REM ุญุฐู ุงููููุฉ ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
echo โณ ุงูุจุญุซ ุนู ููุงู ุณุงุจูุฉ...
schtasks /query /tn %TASK_NAME% > nul 2>&1
if %errorLevel% equ 0 (
    echo โ๏ธ  ุชู ุงูุนุซูุฑ ุนูู ูููุฉ ุณุงุจูุฉุ ุฌุงุฑู ุญุฐููุง...
    schtasks /delete /tn %TASK_NAME% /f > nul 2>&1
    echo โ ุชู ุญุฐู ุงููููุฉ ุงูุณุงุจูุฉ
)

REM ุฅูุดุงุก ุงููููุฉ ุงูุฌุฏูุฏุฉ
echo.
echo โณ ุฌุงุฑู ุฅูุดุงุก ูููุฉ ุฌุฏูุฏุฉ...
schtasks /create /tn %TASK_NAME% ^
    /tr "\"%PYTHON_PATH%\" \"%SCRIPT_PATH%\"" ^
    /sc daily ^
    /st %SCHEDULE_TIME% ^
    /f ^
    /rl highest

if %errorLevel% equ 0 (
    echo โ ุชู ุฅูุดุงุก ุงููููุฉ ุจูุฌุงุญ!
    echo.
    echo ๐ ุชูุงุตูู ุงููููุฉ:
    echo   โโ ุงูุงุณู: %TASK_NAME%
    echo   โโ ุงูุฌุฏูู: ููููุงู
    echo   โโ ุงูููุช: %SCHEDULE_TIME%
    echo   โโ ุงูุณูุฑูุจุช: %SCRIPT_PATH%
    echo   โโ ุงููุณุชูู: Administrator
    echo.
    echo ๐ ุณูุชู ุชุดุบูู ุงูุชูุธูู ุชููุงุฆูุงู:
    echo   โข ุญุฐู ุงูุชูุงุฑูุฑ ุงููุคูุชุฉ (ุฃูุฏู ูู 48 ุณุงุนุฉ)
    echo   โข ุชูุธูู ูููุงุช Cache
    echo   โข ุญุฐู ุงููููุงุช ุงููุฑููุนุฉ (ุฃูุฏู ูู 90 ููู)
    echo   โข ุญุฐู ูููุงุช ุงูุณุฌูุงุช (ุฃูุฏู ูู 30 ููู)
    echo   โข ุชูุธูู ูููุงุช Python ุงููุคูุชุฉ
    echo.
    echo โ ุชู ุงูุฅุนุฏุงุฏ ุจูุฌุงุญ!
) else (
    echo โ ูุดู ุฅูุดุงุก ุงููููุฉ
    pause
    exit /b 1
)

REM ุฅุธูุงุฑ ุชูุงุตูู ุงููููุฉ
echo.
echo โณ ุฌุงุฑู ุนุฑุถ ุชูุงุตูู ุงููููุฉ...
echo.
schtasks /query /tn %TASK_NAME% /v

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo  โ ุงูุชูุช ุนูููุฉ ุงูุฅุนุฏุงุฏ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo ๐ก ูุตุงุฆุญ ูููุฏุฉ:
echo   โข ูุชุดุบูู ุงูุชูุธูู ูุฏููุงู ุงูุขู: python auto_cleanup.py
echo   โข ูุญุฐู ุงููููุฉ: schtasks /delete /tn %TASK_NAME% /f
echo   โข ูุนุฑุถ ุงูุณุฌูุงุช: type cleanup.log
echo.

pause
