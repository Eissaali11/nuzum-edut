# ูุธุงู ุชุตุฏูุฑ Excel ุงูุงุญุชุฑุงูู

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ูุชูุฏู ูุฅูุดุงุก ุชูุงุฑูุฑ Excel ุงุญุชุฑุงููุฉ ูุน ุชุตููู ูุฎู ูุจูุงูุงุช ุดุงููุฉ ูุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ.

## ๐ฆ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
application/services/excel/
โโโ __init__.py              # ุฅุนุงุฏุฉ ุชุตุฏูุฑ ุงููุญุฏุงุช ุงูุฑุฆูุณูุฉ
โโโ styles.py                # ูุธุงู ุงูุฃููุงู ูุงูุชูุณููุงุช ุงูุงุญุชุฑุงููุฉ
โโโ data_extractor.py        # ุงุณุชุฎุฑุงุฌ ููุนุงูุฌุฉ ุงูุจูุงูุงุช
โโโ chart_generator.py       # ุฅูุดุงุก ุงูุฑุณูู ุงูุจูุงููุฉ
โโโ report_builder.py        # ุจูุงุก ุงูุชูุงุฑูุฑ ุงููุงููุฉ
โโโ exporter.py              # ุชุตุฏูุฑ ูุญูุธ ุงููููุงุช
```

## ๐จ ูุธุงู ุงูุฃููุงู ุงููููู

```
Navy Blue (#0D1117)    - ุงูุนูุงููู ูุงูุนูุงุตุฑ ุงูุฃุณุงุณูุฉ
Emerald (#00D4AA)      - ุงูุฅุดุงุฑุงุช ุงูุฅูุฌุงุจูุฉ ูุงููุฌูููุฉ
Cyan (#00D4FF)         - ุงูุนูุงุตุฑ ุงูุซุงูููุฉ
Gold (#FFD700)         - ุงูุฃูุณูุชุงุช ูุงูุชูููุฒ
Light Gray (#ECEFF1)   - ุฎูููุงุช ุงูุจูุงูุงุช

Success (#4CAF50)      - ุญุงูุฉ ุงููุฌุงุญ
Warning (#FFA726)      - ุงูุชุญุฐูุฑุงุช
Danger (#EF5350)       - ุงูุญุงูุงุช ุงูุญุฑุฌุฉ
Info (#29B6F6)         - ุงููุนูููุงุช ุงููุงูุฉ
```

## ๐ ููููุงุช ุงููุธุงู

### 1. **styles.py** - ูุธุงู ุงูุชูุณูู ุงูููุญุฏ

#### ุชุนุฑูู ุงูุฃููุงู
```python
from application.services.excel.styles import ColorPalette

# ุงููุตูู ููุฃููุงู
color = ColorPalette.NAVY_BLUE  # '0D1117'
```

#### ูุฆุงุช ุงูุฎุทูุท
- `header_font()` - ุฎุทูุท ุฑุคูุณ ุงูุนูุงููู (14 ุจุชุ ุนุฑูุถ)
- `subheader_font()` - ุฎุทูุท ุงูุนูุงููู ุงููุฑุนูุฉ (12 ุจุชุ ุนุฑูุถ)
- `title_font()` - ุงูุนููุงู ุงูุฑุฆูุณู (18 ุจุชุ ุนุฑูุถ)
- `normal_font()` - ุงููุตูุต ุงูุนุงุฏูุฉ (11 ุจุช)
- `metric_font()` - ุงูุฃุฑูุงู ูุงูููุงููุณ (12 ุจุชุ ุนุฑูุถ)

#### ูุฌููุนุงุช ุงูุฃููุงุท ุงูุฌุงูุฒุฉ
```python
from application.services.excel.styles import ExcelStyles

styles = ExcelStyles()

# ุงุณุชุฎุฏุงู ุฃููุงุท ูุฌูุนุฉ
header_style = styles.header_style()      # ุฑุคูุณ ูุชูุงููุฉ
metric_style = styles.metric_card_style() # ุจุทุงูุงุช ููุงููุณ
data_style = styles.data_cell_style()      # ุฎูุงูุง ุงูุจูุงูุงุช
```

### 2. **data_extractor.py** - ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช

#### ูุนุงูุฌ ุงูุจูุงูุงุช (DataProcessor)
```python
from application.services.excel.data_extractor import DataProcessor

processor = DataProcessor()

# ุญุณุงุจ ุงููุฌุงููุน
totals = processor.calculate_totals(dataframe, ['amount', 'cost'])

# ุญุณุงุจ ุงููุชูุณุทุงุช
averages = processor.calculate_averages(dataframe, ['rating'])

# ุญุณุงุจ ุงููุณุจุฉ ุงููุฆููุฉ
percentage = processor.calculate_percentage(50, 100)  # 50.0

# ุชุตููุฉ ุงูุจูุงูุงุช
filtered = processor.filter_by_date_range(df, 'date_col', start, end)

# ุชุฌููุน ูุฌูุน
grouped = processor.group_and_sum(df, ['category'], ['amount'])

# ุงูุญุตูู ุนูู ุฃูุถู n ุตููู
top_10 = processor.get_top_n(df, 'sales', n=10)
```

#### ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช (DataExtractor)
```python
from application.services.excel.data_extractor import DataExtractor

extractor = DataExtractor()

# ููุงููุณ ููุญุฉ ุงูููุงุฏุฉ
metrics = extractor.get_dashboard_metrics()
# {
#     'total_records': 150,
#     'today_records': 15,
#     'growth_rate': 25.5,
#     'generated_date': '2026-02-20 10:30:00'
# }

# ุชูุฒูุน ุงููุฆุงุช
categories = extractor.get_category_distribution()
# DataFrame ุจู columns: [ุงููุฆุฉ, ุงูุนุฏุฏ, ุงููุณุจุฉ]

# ุงูุงุชุฌุงูุงุช ุงูุดูุฑูุฉ
trends = extractor.get_monthly_trends()
# DataFrame ุจู columns: [ุงูุดูุฑ, ุงููุจูุนุงุช, ุงูุชูุงููู, ุงูุฃุฑุจุงุญ]

# ุจูุงูุงุช ุงูุฃุฏุงุก
performance = extractor.get_performance_data()
# DataFrame ุจู columns: [ุงููุญุฏุฉ, ุงููุฏู, ุงูููุฌุฒ, ุงููุณุจุฉ, ุงูุญุงูุฉ]

# ุงูููุธููู ุงูุฃูุถู ุฃุฏุงุกู
top_performers = extractor.get_top_performers(limit=10)
# DataFrame ูุน ุชุฑุชูุจ ูุชููููุงุช
```

### 3. **chart_generator.py** - ุฅูุดุงุก ุงูุฑุณูู ุงูุจูุงููุฉ

```python
from application.services.excel.chart_generator import ChartGenerator

charts = ChartGenerator()

# ุฑุณู ุจูุงูู ุฏุงุฆุฑู
pie = charts.create_pie_chart(
    data=category_df,
    category_column='ุงููุฆุฉ',
    value_column='ุงูุนุฏุฏ',
    title='ุชูุฒูุน ุงููุฆุงุช',
    sheet=worksheet,
    position='A1'
)

# ุฑุณู ุจูุงูู ุนููุฏู
bar = charts.create_bar_chart(
    data=monthly_df,
    category_column='ุงูุดูุฑ',
    value_columns=['ุงููุจูุนุงุช', 'ุงูุชูุงููู'],
    title='ุงููุจูุนุงุช ูุงูุชูุงููู',
    sheet=worksheet,
    position='A15'
)

# ุฑุณู ุจูุงูู ุฎุทู
line = charts.create_line_chart(
    data=trends_df,
    x_column='ุงูุดูุฑ',
    y_columns=['ุงููุจูุนุงุช', 'ุงูุฃุฑุจุงุญ'],
    title='ุงูุงุชุฌุงูุงุช ุงูุดูุฑูุฉ',
    sheet=worksheet,
    position='A30'
)

# ุฑุณู ุจูุงูู ุฏุงุฆุฑู ููุฑุบ
doughnut = charts.create_doughnut_chart(
    data=status_df,
    category_column='ุงูุญุงูุฉ',
    value_column='ุงูุนุฏุฏ',
    title='ุญุงูุฉ ุงููุดุงุฑูุน',
    sheet=worksheet,
    position='J1'
)
```

### 4. **report_builder.py** - ุจูุงุก ุงูุชูุงุฑูุฑ

#### ุจูุงุก ุงูุฃูุฑุงู (SheetBuilder)
```python
from application.services.excel.report_builder import SheetBuilder

builder = SheetBuilder()

# ุจูุงุก ุฑุฃุณ ุงูุตูุญุฉ
builder.build_header(
    sheet,
    title='ููุญุฉ ุงูููุงุฏุฉ ุงูุดุงููุฉ',
    subtitle='ุชูุฑูุฑ ุดุงูู ููุฃุฏุงุก',
    row=1
)

# ุจูุงุก ูุณู ุงูููุงููุณ
builder.build_metrics_section(
    sheet,
    metrics={'total_records': 150, 'today_records': 15},
    start_row=4
)

# ุจูุงุก ุฌุฏูู ุงูุจูุงูุงุช
last_row = builder.build_table(
    sheet,
    data=dataframe,
    start_row=10
)

# ุฅุถุงูุฉ ุงูุชุฐููู
builder.add_footer(
    sheet,
    text='ุชู ุฅูุดุงุก ุงูุชูุฑูุฑ ูู 2026-02-20',
    last_row=last_row
)
```

#### ุจูุงุก ุงูุชูุฑูุฑ ุงููุงูู (ReportBuilder)
```python
from application.services.excel.report_builder import ReportBuilder
from openpyxl import Workbook

builder = ReportBuilder()
workbook = Workbook()

# ุจูุงุก ุงูุชูุฑูุฑ ุงููุงูู
complete_wb = builder.build_complete_report(workbook)
# ููุดุฆ:
# - ูุฑูุฉ "ููุญุฉ ุงูุนูู" ูุน ุงูููุงููุณ ูุงูุจูุงูุงุช
# - ูุฑูุฉ "ุงูุชูุงุตูู" ูุน ุงูุฃุฏุงุก ูุงูููุงุฑุฏ ุงูุจุดุฑูุฉ
```

### 5. **exporter.py** - ุงูุชุตุฏูุฑ ูุงูุญูุธ

```python
from application.services.excel.exporter import ExcelExporter

exporter = ExcelExporter(
    reports_dir='instance/reports'  # ุงููุฌูุฏ ุงูุงูุชุฑุงุถู
)

# ุฅูุดุงุก ูุชุตุฏูุฑ ุงูุชูุฑูุฑ
buffer, filename, mimetype = exporter.export_to_buffer()
# buffer: BytesIO object ููููู
# filename: ุงุณู ุงูููู (Report_20260220_002737.xlsx)
# mimetype: application/vnd....

# ุงูุญุตูู ุนูู ุฃุญุฏุซ ุชูุฑูุฑ
result = exporter.get_latest_report()
if result:
    buffer, filename, mimetype = result

# ุญุฐู ุงูุชูุงุฑูุฑ ุงููุฏููุฉ
exporter.cleanup_old_reports(keep_count=10)
```

## ๐ ุงูุงุณุชุฎุฏุงู ุงูุณุฑูุน

### ูู Flask Route

```python
from flask import Blueprint, send_file
from application.services.excel.exporter import ExcelExporter

analytics_bp = Blueprint('analytics', __name__)

@analytics_bp.route('/export/professional-report')
def export_report():
    """ุชุตุฏูุฑ ุงูุชูุฑูุฑ ุงูุงุญุชุฑุงูู"""
    exporter = ExcelExporter()
    buffer, filename, mimetype = exporter.export_to_buffer()
    
    return send_file(
        buffer,
        mimetype=mimetype,
        as_attachment=True,
        download_name=filename
    )
```

### ูู ุงูุณูุฑูุจุช

```python
from application.services.excel.exporter import ExcelExporter

exporter = ExcelExporter()

# ุฅูุดุงุก ุงูุชูุฑูุฑ
buffer, filename = exporter.generate_report()

# ุงููุตูู ุฅูู BytesIO
excel_data = buffer.getvalue()

# ุญูุธ ูุญููุงู
with open(filename, 'wb') as f:
    f.write(excel_data)
```

## โ ุงูููุฒุงุช

### ุชุตููู ุงุญุชุฑุงูู
- โ ูุธุงู ุฃููุงู ูุชูุงุณู ููููู
- โ ุฎุทูุท ุนุงููุฉ ุงูุฌูุฏุฉ ูุงุจูุฉ ูููุฑุงุกุฉ
- โ ูุญุงุฐุงุฉ RTL ูุงููุฉ ููุนุฑุจูุฉ
- โ ุญุฏูุฏ ูููุก ููููุฉ

### ุงูุจูุงูุงุช ูุงูุฑุณูู ุงูุจูุงููุฉ
- โ ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุฏููุงูููู
- โ ูุนุงูุฌุฉ ูุญุณุงุจุงุช ูุชูุฏูุฉ
- โ ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ ูุชุนุฏุฏุฉ ุงูุฃููุงุน
- โ ุฌุฏุงูู ููุณูุฉ ุงุญุชุฑุงููุงู

### ุงูููุฏ ุงููุธูู
- โ ูุตู ุงููุณุคูููุงุช (Separation of Concerns)
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ
- โ ุชูุซูู ุดุงูู ุจุงูุนุฑุจูุฉ
- โ ูุงุจู ููุชูุณุน ูุงูุตูุงูุฉ

### ุฅุฏุงุฑุฉ ุงููููุงุช
- โ ุชุณููุฉ ูุฑูุฏุฉ ูููููุงุช
- โ ุญูุธ ูุญูู ุชููุงุฆู
- โ ุงุณุชุฑุฌุงุน ุฃุญุฏุซ ุชูุฑูุฑ
- โ ุชูุธูู ุงูุชูุงุฑูุฑ ุงููุฏููุฉ

## ๐ ูุซุงู ุนูู ุงูุชูุฑูุฑ ุงูููุชุฌ

**ูุฑูุฉ 1: ููุญุฉ ุงูุนูู**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          ููุญุฉ ุงูููุงุฏุฉ ุงูุดุงููุฉ                         โ
โ     ุชูุฑูุฑ ุดุงูู ููุฃุฏุงุก ูุงูุฅุญุตุงุฆูุงุช                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโ
โ ุฅุฌูุงูู ุงูุณุฌูุงุช โ  ุณุฌูุงุช ุงูููู   โ  ูุนุฏู ุงูููู     โ
โโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโค
โ      150        โ       15        โ      25.50%      โ
โโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโ

ุชูุฒูุน ุงููุฆุงุช
โโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโโ
โ      ุงููุฆุฉ        โ ุงูุนุฏุฏ  โ ุงููุณุจุฉ  โ
โโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโผโโโโโโโโโโค
โ ุฅุฏุงุฑุฉ ุงูุชุณููู    โ   45   โ  28.5%  โ
โ ุงูุฌูุฏุฉ            โ   28   โ  17.7%  โ
โ ุงูุฃุฏุงุก            โ   35   โ  22.2%  โ
โ ุงูุณูุงูุฉ            โ   22   โ  13.9%  โ
โ ุฃุฎุฑู              โ   15   โ   9.5%  โ
โโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโดโโโโโโโโโโ

ุงูุงุชุฌุงูุงุช ุงูุดูุฑูุฉ
โโโโโโโโโโโโฌโโโโโโโโโโโโฌโโโโโโโโโโโโฌโโโโโโโโโโโ
โ  ุงูุดูุฑ   โ ุงููุจูุนุงุช  โ ุงูุชูุงููู โ ุงูุฃุฑุจุงุญ  โ
โโโโโโโโโโโโผโโโโโโโโโโโโผโโโโโโโโโโโโผโโโโโโโโโโโค
โ ููุงูุฑ   โ  15,000   โ  8,000   โ  7,000  โ
โ ูุจุฑุงูุฑ   โ  18,000   โ  9,500   โ  8,500  โ
โ ูุงุฑุณ     โ  22,000   โ  11,000  โ  11,000 โ
โโโโโโโโโโโโดโโโโโโโโโโโโดโโโโโโโโโโโโดโโโโโโโโโโโ

[ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ]
```

**ูุฑูุฉ 2: ุงูุชูุงุตูู**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ            ุชูุฑูุฑ ุงูุชูุงุตูู                             โ
โ    ุจูุงูุงุช ุงูุฃุฏุงุก ูุงูููุงุฑุฏ ุงูุจุดุฑูุฉ                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ุจูุงูุงุช ุงูุฃุฏุงุก
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโ
โ    ุงููุญุฏุฉ        โ ุงููุฏู  โ ุงูููุฌุฒ  โุงููุณุจุฉ โ
โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโค
โ ุงููุญุฏุฉ ุงูุฃููู   โ  100   โ   98    โ 98%  โ
โ ุงููุญุฏุฉ ุงูุซุงููุฉ   โ   95   โ   92    โ 96.8% โ
โโโโโโโโโโโโโโโโโโโโดโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโ

ุงูููุธููู ุงูุฃูุถู ุฃุฏุงุกู
โโโโโโโโฌโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโโโ
โุงูุชุฑุชูุจโ    ุงูุงุณู      โ ุงูุฃุฏุงุก  โ ุงูุชูููู   โ
โโโโโโโโผโโโโโโโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโโโโค
โ  1   โ ุงูููุธู 1      โ   95    โ โญโญโญโญโญ โ
โ  2   โ ุงูููุธู 2      โ   93    โ โญโญโญโญโญ โ
โโโโโโโโดโโโโโโโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโโโ
```

## ๐งช ุงูุงุฎุชุจุงุฑุงุช

ุชุดุบูู ุงุฎุชุจุงุฑ ุดุงูู:
```bash
python test_professional_report.py
```

ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช:
- โ ุงุฎุชุจุงุฑ ุงูุฃููุงุท
- โ ุงุฎุชุจุงุฑ ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
- โ ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงูุชูุฑูุฑ
- โ ุงุฎุชุจุงุฑ ุงูุชุตุฏูุฑ
- โ ุงุฎุชุจุงุฑ ุงุณุชุฑุฌุงุน ุฃุญุฏุซ ุชูุฑูุฑ
- โ ุงุฎุชุจุงุฑ ุชูุธูู ุงูุชูุงุฑูุฑ

## ๐ ูุนุงููุฑ ุงูุฃุฏุงุก

- ๐ ุฅูุดุงุก ุงูุชูุฑูุฑ: < 500ms
- ๐พ ุญุฌู ุงูููู: ~7KB ูุถุบูุท
- ๐ ุนุฏุฏ ุงูุฃูุฑุงู: ููุจูู (2+)
- ๐จ ุฌูุฏุฉ ุงูุชุตููู: ุงุญุชุฑุงููุฉ ุนุงููุฉ

## ๐ง ุงูุชุทููุฑ ูุงูุชูุณุน

### ุฅุถุงูุฉ ูุตุฏุฑ ุจูุงูุงุช ุฌุฏูุฏ

```python
# ูู data_extractor.py
def get_custom_report(self) -> pd.DataFrame:
    """ุงุณุชุฎุฑุงุฌ ุชูุฑูุฑ ูุฎุตุต"""
    try:
        # ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
        data = {...}
        return pd.DataFrame(data)
    except Exception as e:
        return pd.DataFrame()
```

### ุฅุถุงูุฉ ุฑุณู ุจูุงูู ุฌุฏูุฏ

```python
# ูู report_builder.py
def create_custom_sheet(self, workbook):
    sheet = workbook.create_sheet('ูุฎุตุต')
    
    # ุฅุถุงูุฉ ุงูุฑุณูู ุงูุจูุงููุฉ
    custom_chart = self.chart_generator.create_pie_chart(...)
    ChartGenerator.add_chart_to_sheet(sheet, custom_chart)
```

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงููุฌูุฏ ุงูุงูุชุฑุงุถู**: `instance/reports/`
2. **ุตูุบุฉ ุงูููู**: `.xlsx` (Excel 2007+)
3. **ุงูุชุฑููุฒ**: UTF-8 ูุงูู ูุน ุฏุนู ุงูุนุฑุจูุฉ RTL
4. **ูุทุงู ุงูุชูุงูู**: Excel, LibreOffice, Google Sheets
5. **ุงูุญุฏ ุงูุฃูุตู ููุตููู**: 1,048,576 (ุญุฏ Excel)

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูููุงุญุธุงุชุ ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุชูุซูู ุงููุถููุฉ ูู ุงูููุฏ ูุน ุงุณุชุฎุฏุงู docstrings ุงูุดุงููุฉ.

---

ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ: ูุธุงู ุงูุชูุงุฑูุฑ ุงูุงุญุชุฑุงูู
ุงูุชุงุฑูุฎ: 2026-02-20
ุงูุฅุตุฏุงุฑ: 1.0
