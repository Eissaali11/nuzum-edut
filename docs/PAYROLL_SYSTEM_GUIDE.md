# ูุธุงู ุงูุฑูุงุชุจ ุงูุงุณุชุฑุงุชูุฌู ูู Nuzum HR
## Strategic Payroll Engine for Nuzum HR

ูุธุงู ุดุงูู ูุฅุฏุงุฑุฉ ูุญุณุงุจ ุงูุฑูุงุชุจ ูููุงู ููููุงููู ุงูุนูุงููุฉ ุงูุณุนูุฏูุฉ ูุน ุฏุนู ูุงูู ูู 76 ููุธูุงู.

---

## ๐ ุงููุญุชููุงุช

1. [ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ](#ุงูููุฒุงุช-ุงูุฑุฆูุณูุฉ)
2. [ุงูุจููุฉ ุงููุนูุงุฑูุฉ](#ุงูุจููุฉ-ุงููุนูุงุฑูุฉ)
3. [ุงูููููุงุช ุงูุฃุณุงุณูุฉ](#ุงูููููุงุช-ุงูุฃุณุงุณูุฉ)
4. [ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู](#ุทุฑููุฉ-ุงูุงุณุชุฎุฏุงู)
5. [ุงูุตูุบ ูุงูุญุณุงุจุงุช](#ุงูุตูุบ-ูุงูุญุณุงุจุงุช)
6. [ุชุตุฏูุฑ ุงูุจูุงูุงุช](#ุชุตุฏูุฑ-ุงูุจูุงูุงุช)
7. [ุงูุฃูุงู ูุงูุงูุชุซุงู](#ุงูุฃูุงู-ูุงูุงูุชุซุงู)

---

## โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. **ุญุณุงุจ ุงูุฑูุงุชุจ ุงูุชููุงุฆู**
- ุญุณุงุจ ุงููุนุงููุงุช ุจูุงุกู ุนูู ุจูุงูุงุช ุงูุญุถูุฑ ุงููุนููุฉ
- ุฏุนู ุงูุฎุตููุงุช ุงููุชุนุฏุฏุฉ (ุบูุงุจุ ุชุฃุฎูุฑุ ูุฑูุถุ ุฅูุฎ)
- ุญุณุงุจ ุงููุฒุงูุง (ุณููุ ูููุ ุทุนุงูุ ุฅูุฎ)
- ุญุณุงุจ ุงูุถูุงู ุงูุงุฌุชูุงุนู ุญุณุจ ุงูุฌูุณูุฉ

### 2. **ุณูุฑ ุนูู ุงูููุงููุฉ**
- ูุนุงูุฌุฉ ุฃูููุฉ โ ูุฑุงุฌุนุฉ โ ููุงููุฉ โ ุฏูุน
- ุฅููุงููุฉ ุฑูุถ ุงูุฑูุงุชุจ ูุน ุชุญุฏูุฏ ุงูุณุจุจ
- ููุงููุฉ ุฌูุงุนูุฉ ุนูู ุนุฏุฉ ุฑูุงุชุจ
- ุชุชุจุน ูุงูู ูุณุฌู ุงูุชุบููุฑุงุช

### 3. **ุงูุชุตุฏูุฑ ุงูุจููู**
- ุชุตุฏูุฑ ุฅูู ุฃุดูุงู ูุชุนุฏุฏุฉ: TXT, CSV, XML
- ุฏุนู ุงูุจููู ุงูุณุนูุฏูุฉ ุงูุฑุฆูุณูุฉ:
  - ุงูุจูู ุงูุฃููู (NCB)
  - ุจูู ุงูุฑูุงุถ
  - ุจูู ุณุงูุจุง
  - ุงูุจูู ุงูุฑุงุฌุญู
  - ูุงููุฒูุฏ...
- ุชูุณูู ูุชูุงูู ูุน ูุนุงููุฑ ูุธุงู SADAD

### 4. **ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช**
- ูุนุงููุงุช ุงูุถูุงู ุงูุงุฌุชูุงุนู
- ูุนุฏูุงุช ุงูุถุฑุงุฆุจ
- ุงููุฒุงูุง ุงูุงูุชุฑุงุถูุฉ
- ุฃูุงู ุงูุนูู ูุงูุฅุฌุงุฒุงุช

### 5. **ุงูุชูุงุฑูุฑ ูุงูุชุญูููุงุช**
- ููุญุฉ ุชุญูู ุดุงููุฉ ุจุฅุญุตุงุฆูุงุช ุงูุฑูุงุชุจ
- ุชูุงุฑูุฑ Excel ูุงุจูุฉ ููุชุญููู
- ููุฎุตุงุช ูุงููุฉ ุดูุฑูุฉ
- ุชุชุจุน ุญุงูุงุช ุงูุฑูุงุชุจ

---

## ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

### ุทุจูุงุช ุงููุธุงู:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Frontend (HTML/CSS/JS)          โ
โ  Dashboard | Review | Details | Config  โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Routes Layer (Flask)            โ
โ  payroll_admin.py (12 Routes)           โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Application Layer (Services)       โ
โ  PayrollProcessor                       โ
โ  BankTransferGenerator                  โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Domain Layer (Models)              โ
โ  PayrollRecord                          โ
โ  PayrollConfiguration                   โ
โ  PayrollHistory                         โ
โ  BankTransferFile                       โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Database Layer (SQLAlchemy)        โ
โ  PostgreSQL / MySQL / SQLite            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฆ ุงูููููุงุช ุงูุฃุณุงุณูุฉ

### 1. ููุงุฐุฌ ุงูุจูุงูุงุช (Models)
**ุงูููู:** `modules/payroll/domain/models.py`

#### PayrollRecord
- ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ ููุฑุงุชุจ ุงูุดูุฑู ููู ููุธู
- ูขู+ ุญูู ูุชุชุจุน ุฌููุน ุงูููููุงุช ุงููุงููุฉ
- ุญููู ููููุงููุฉ ูุงูุชุงุฑูุฎ

#### PayrollConfiguration
- ุฅุนุฏุงุฏุงุช ุงููุธุงู ุงูุนุงูุฉ
- ูุนุงููุงุช ุงูุถูุงู ูุงูุถุฑุงุฆุจ
- ุงูุญุฏูุฏ ุงูุฏููุง ูุงูููู ุงูุงูุชุฑุงุถูุฉ

#### PayrollHistory
- ุณุฌู ุชุฏูููู (Audit Trail)
- ุชุชุจุน ุฌููุน ุงูุชุนุฏููุงุช
- ูุนูููุงุช ูู ุบููุฑ ุงููููุฉ ููุชู

#### BankTransferFile
- ุชุชุจุน ูููุงุช ุงูุชุญููู ุงูุจููู
- ูุนูููุงุช ุงูููู ูุงูุตูุบุฉ
- ุงูุญุงูุฉ ูุงูุชูุงุฑูุฎ

### 2. ูุนุงูุฌ ุงูุฑูุงุชุจ (PayrollProcessor)
**ุงูููู:** `modules/payroll/application/payroll_processor.py`

ุงูุฏูุงู ุงูุฑุฆูุณูุฉ:
- `process_employee_payroll()`: ูุนุงูุฌุฉ ุฑุงุชุจ ููุธู ูุงุญุฏ
- `process_all_employees()`: ูุนุงูุฌุฉ ุฌููุน ุงูููุธููู
- `calculate_daily_rate()`: ุญุณุงุจ ุงูุฃุฌุฑ ุงููููู
- `calculate_absence_deduction()`: ุญุณุงุจ ุฎุตู ุงูุบูุงุจ
- `calculate_gosi()`: ุญุณุงุจ ุงูุถูุงู ุงูุงุฌุชูุงุนู
- `approve_payroll()`: ุงูููุงููุฉ ุนูู ุงูุฑุงุชุจ
- `reject_payroll()`: ุฑูุถ ุงูุฑุงุชุจ

### 3. ูููุฏ ุงูุชุญูููุงุช ุงูุจูููุฉ (BankTransferGenerator)
**ุงูููู:** `modules/payroll/application/bank_transfer_generator.py`

ุงูุฏูุงู ุงูุฑุฆูุณูุฉ:
- `generate_txt_format()`: ุชูููุฏ ุตูุบุฉ TXT
- `generate_csv_format()`: ุชูููุฏ ุตูุบุฉ CSV
- `generate_xml_format()`: ุชูููุฏ ุตูุบุฉ XML
- `create_transfer_file()`: ุฅูุดุงุก ููู ุงูุชุญููู ุงูููุงุฆู
- `export_to_excel_sheet()`: ุฅุถุงูุฉ ุจูุงูุงุช ุฅูู ููู Excel

### 4. ุทุฑู ุงููุณุงุฑ (Routes)
**ุงูููู:** `routes/payroll_admin.py`

#### ุงููุณุงุฑุงุช ุงูุฑุฆูุณูุฉ:
```
GET    /payroll/dashboard           - ููุญุฉ ุงูุชุญูู
GET    /payroll/process             - ูููุฐุฌ ุงููุนุงูุฌุฉ
POST   /payroll/process             - ุชูููุฐ ุงููุนุงูุฌุฉ
GET    /payroll/review              - ูุฑุงุฌุนุฉ ุงูุฑูุงุชุจ
GET    /payroll/<id>/details        - ุชูุงุตูู ุงูุฑุงุชุจ
POST   /payroll/<id>/approve        - ุงูููุงููุฉ
POST   /payroll/<id>/reject         - ุงูุฑูุถ
POST   /payroll/batch-approve       - ููุงููุฉ ุฌูุงุนูุฉ
POST   /payroll/bank-transfer/create - ุฅูุดุงุก ููู ุจููู
GET    /payroll/bank-transfer/<id>/download - ุชุญููู ุงูููู
GET    /payroll/export/excel        - ุชุตุฏูุฑ Excel
GET    /payroll/configuration       - ุฅุนุฏุงุฏุงุช ุงููุธุงู
POST   /payroll/configuration/save  - ุญูุธ ุงูุฅุนุฏุงุฏุงุช
```

---

## ๐ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุฎุทูุฉ 1: ุชุซุจูุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
# ุฅูุดุงุก ุงูููุงุฌุฑุฉ
flask db migrate -m "Add payroll system"

# ุชุทุจูู ุงูููุงุฌุฑุฉ
flask db upgrade
```

### ุงูุฎุทูุฉ 2: ุงููุตูู ุฅูู ุงููุธุงู

1. ุงูุชูู ุฅูู `http://localhost:5000/payroll/dashboard`
2. ุชุฃูุฏ ูู ูุฌูุฏ ุงูุตูุงุญูุงุช ุงููุทููุจุฉ

### ุงูุฎุทูุฉ 3: ุฅุนุฏุงุฏ ุงููุธุงู

1. ูู ุจุฒูุงุฑุฉ `/payroll/configuration`
2. ุฃุฏุฎู ูุนุงููุงุช ุงูุถูุงู ุงูุงุฌุชูุงุนู
3. ุญุฏุฏ ูุนุฏูุงุช ุงูุถุฑุงุฆุจ ูุงููุฒุงูุง ุงูุงูุชุฑุงุถูุฉ
4. ุงููุฑ ุนูู "ุญูุธ ุงูุฅุนุฏุงุฏุงุช"

### ุงูุฎุทูุฉ 4: ูุนุงูุฌุฉ ุงูุฑูุงุชุจ

1. ุงูุชูู ุฅูู `/payroll/process`
2. ุงุฎุชุฑ ุงูุดูุฑ ูุงูุณูุฉ
3. ุงููุฑ ุนูู "ุจุฏุก ุงููุนุงูุฌุฉ"
4. ุงูุชุธุฑ ุญุชู ุชูุชูู ุงููุนุงูุฌุฉ

### ุงูุฎุทูุฉ 5: ูุฑุงุฌุนุฉ ูุงูููุงููุฉ

1. ุงูุชูู ุฅูู `/payroll/review`
2. ุฑุงุฌุน ุงูุฑูุงุชุจ ุญุณุจ ุงูุญุงูุฉ
3. ุงุถุบุท ุนูู "ุชูุงุตูู" ููุนุฑุถ ุงููุงูู
4. ุงุถุบุท ุนูู "ููุงููุฉ" ุฃู "ุฑูุถ"

### ุงูุฎุทูุฉ 6: ุงูุชุตุฏูุฑ ุงูุจููู

1. ุงูุชูู ุฅูู `/payroll/review`
2. ุญุฏุฏ ุงูุฑูุงุชุจ ุงููุนุชูุฏุฉ
3. ุงููุฑ ุนูู "ุฅูุดุงุก ููู ุจููู"
4. ุงุฎุชุฑ ุงูุจูู ูุงูุตูุบุฉ (TXT/CSV/XML)
5. ุงุญูุธ ุงูููู

---

## ๐งฎ ุงูุตูุบ ูุงูุญุณุงุจุงุช

### 1. ุญุณุงุจ ุงูุฃุฌุฑ ุงููููู
```
ุงูุฃุฌุฑ ุงููููู = ุงูุฑุงุชุจ ุงูุฃุณุงุณู รท 30
```
ูุนูุงุฑ ููุญุฏ ุจุบุถ ุงููุธุฑ ุนู ุนุฏุฏ ุฃูุงู ุงูุดูุฑ

### 2. ุฎุตู ุงูุบูุงุจ
```
ุฎุตู ุงูุบูุงุจ = ุงูุฃุฌุฑ ุงููููู ร ุนุฏุฏ ุฃูุงู ุงูุบูุงุจ
```

### 3. ุงูุฑุงุชุจ ุงูุฅุฌูุงูู (Gross Salary)
```
ุงูุฑุงุชุจ ุงูุฅุฌูุงูู = ุงูุฑุงุชุจ ุงูุฃุณุงุณู 
               + ูุฒูุฉ ุงูุณูู 
               + ูุฒูุฉ ุงูููู 
               + ูุฒูุฉ ุงูุทุนุงู 
               + ููุงูุฃุฉ ุงูุฃุฏุงุก 
               + ููุงูุฃุฉ ุงูุญุถูุฑ 
               + ุงููุฒุงูุง ุงูุฃุฎุฑู
```

### 4. ุงูุถูุงู ุงูุงุฌุชูุงุนู (GOSI)

**ููููุธููู ุงูุณุนูุฏููู:**
```
GOSI ุงูููุธู = ุงูุฑุงุชุจ ุงูุฃุณุงุณู ร 10%
GOSI ุงูุดุฑูุฉ = ุงูุฑุงุชุจ ุงูุฃุณุงุณู ร 13%
```

**ููููุธููู ุงูุฃุฌุงูุจ:**
- ุญุณุจ ุงูุนูุฏ ูุงูุงุฑุชุจุงุทุงุช ุงูุฏูููุฉ

### 5. ุฅุฌูุงูู ุงูุฎุตููุงุช
```
ุงูุฎุตููุงุช = ุฎุตู ุงูุบูุงุจ 
        + ุฎุตู ุงูุชุฃุฎูุฑ 
        + ุฎุตู ุงููุบุงุฏุฑุฉ ุงููุจูุฑุฉ 
        + GOSI ุงูููุธู 
        + ุถุฑูุจุฉ ุงูุฏุฎู 
        + ุฎุตู ุงููุฑุถ 
        + ุงูุณููุฉ 
        + ุฎุตู ุงูุชุฃููู
```

### 6. ุงูุฑุงุชุจ ุงูุตุงูู (Net Payable)
```
ุงูุฑุงุชุจ ุงูุตุงูู = ุงูุฑุงุชุจ ุงูุฅุฌูุงูู - ุงูุฎุตููุงุช
```

---

## ๐พ ุชุตุฏูุฑ ุงูุจูุงูุงุช

### ุตูุบุฉ TXT (ููุจููู ุงูุณุนูุฏูุฉ)
```
001|0010|2025-01-15|140500|SAR|NUZUM000
1|E001|Ahmed Mohammed|1234567890|250000|2025-01-15|SALARY
2|E002|Fatima Ali|0987654321|245000|2025-01-15|SALARY
...
999|76|18500000|2025-01-15
```

### ุตูุบุฉ CSV (ููู Excel)
```
Name,EmployeeID,BankAccount,Bank,Amount,Date,Description
Ahmed Mohammed,E001,1234567890,NCB,250000,2025-01-15,SALARY
Fatima Ali,E002,0987654321,RAJHI,245000,2025-01-15,SALARY
```

### ุตูุบุฉ XML (ููุฃูุธูุฉ ุงููุชูุฏูุฉ)
```xml
<?xml version="1.0" encoding="UTF-8"?>
<BankTransferFile>
  <Header>
    <BankCode>0010</BankCode>
    <Date>2025-01-15</Date>
    <TotalRecords>76</TotalRecords>
  </Header>
  <Transactions>
    <Transaction>
      <EmployeeID>E001</EmployeeID>
      <Name>Ahmed Mohammed</Name>
      <BankAccount>1234567890</BankAccount>
      <Amount>250000</Amount>
    </Transaction>
  </Transactions>
</BankTransferFile>
```

---

## ๐ ุงูุฃูุงู ูุงูุงูุชุซุงู

### 1. ุงูุชุญูู ุจุงููุตูู
- ุชุญูู ูู ุงูุตูุงุญูุงุช ูุจู ูู ุนูููุฉ
- ุฏุนู ุงูุฃุฏูุงุฑ ุงููุฎุชููุฉ (ูุญุงุณุจุ ูุฏูุฑุ ูุณุคูู)

### 2. ุงูุงูุชุซุงู ุงููุงูููู
- โ ูุงููู ุงูุนูู ุงูุณุนูุฏู
- โ ูุนุงููุฑ ุงูุถูุงู ุงูุงุฌุชูุงุนู
- โ ูุนุงููุฑ ุงูุถุฑูุจุฉ
- โ ูุธุงู SADAD ููุชุญูููุงุช

### 3. ุชุชุจุน ุงูุชุฏููู
- ุชุณุฌูู ุฌููุน ุงูุชุนุฏููุงุช ูู PayrollHistory
- ูุนูููุงุช ูู ูุงู ุจุงูุชุบููุฑ ูุงูููุช
- ุฅููุงููุฉ ุงูุงุณุชุฑุฌุงุน ููุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ

### 4. ุงูุฏูุฉ ุงููุงููุฉ
- ุงุณุชุฎุฏุงู ููุน Decimal (ูููุณ Float)
- ุงูุชูุฑูุจ ุงูุตุญูุญ ูููููุณ (Fils)
- ุงูุชุญูู ูู ุงููุฌุงููุน

### 5. ุงูุฎุตูุตูุฉ
- ุญูุงูุฉ ุจูุงูุงุช ุงูููุธููู
- ุนุฏู ุฅูุดุงุก ุงููุนูููุงุช ุงูุญุณุงุณุฉ
- ุชุณุฌูู ุงููุตูู ูุงูุชุนุฏููุงุช

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ

### ููุญุฉ ุงูุชุญูู ุชุนุฑุถ:
- ุนุฏุฏ ุงูููุธููู ุงูููู
- ุนุฏุฏ ุงูุฑูุงุชุจ ููุฏ ุงูุงูุชุธุงุฑ
- ุนุฏุฏ ุงูุฑูุงุชุจ ุงููุนุชูุฏุฉ
- ุนุฏุฏ ุงูุฑูุงุชุจ ุงููุฑููุถุฉ
- ุนุฏุฏ ุงูุฑูุงุชุจ ุงููุฏููุนุฉ
- ุงูุฑุงุชุจ ุงูุฅุฌูุงูู ุงูุดูุฑู
- ุงูุฎุตููุงุช ุงููููุฉ
- ุงูุฑุงุชุจ ุงูุตุงูู ุงูููู
- ุฃุญุฏุซ ุงููุนุงูุฌุงุช

### ุชูุงุฑูุฑ Excel ุชุชุถูู:
- ุจูุงูุงุช ุฌููุน ุงูููุธููู
- ุชูุงุตูู ุงูุฑูุงุชุจ ูุงูุฎุตููุงุช
- ุงูุญุงูุฉ ูุงูุชูุงุฑูุฎ
- ุงููุฌุงููุน ูุงููุณุจ ุงููุฆููุฉ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูุฑูุงุชุจ ูุง ุชูุนุงูุฌ

**ุงูุญู:**
1. ุชุฃูุฏ ูู ูุฌูุฏ ุณุฌูุงุช ุญุถูุฑ ููููุธููู
2. ุชุญูู ูู ูุนุงููุงุช ุงูุฅุนุฏุงุฏุงุช
3. ุชุญูู ูู ุณุฌูุงุช ุงูุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงููุดููุฉ: ุงูุฃุฑูุงู ุบูุฑ ุตุญูุญุฉ

**ุงูุญู:**
1. ุฑุงุฌุน ุญุณุงุจุงุช ุงูุญุถูุฑ
2. ุชุญูู ูู ูุนุงููุงุช ุงูุถูุงู ุงูุงุฌุชูุงุนู
3. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ููุน Decimal

### ุงููุดููุฉ: ุงูููู ุงูุจููู ูุง ูููุจู

**ุงูุญู:**
1. ุชุญูู ูู ุตูุบุฉ ุงูุจูู ุงููุณุชุฎุฏู
2. ุชุญูู ูู ุฃู ุงูุฑูู ุงูุจููู ููููุธู ุตุญูุญ
3. ุฌุฑุจ ุตูุบุฉ ูุฎุชููุฉ (CSV ุจุฏูุงู ูู TXT)

---

## ๐ ุงููุฑุงุฌุน

- [ูุธุงู ุงูุถูุงู ุงูุงุฌุชูุงุนู ุงูุณุนูุฏู](https://www.gosi.gov.sa)
- [ูุฒุงุฑุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุงูุชูููุฉ ุงูุงุฌุชูุงุนูุฉ](https://www.mhrsd.gov.sa)
- [ูุธุงู SADAD ููุชุญูููุงุช](https://www.sadad.qa)

---

## ๐ ุงูููุงุญุธุงุช

- ุชู ุจูุงุก ุงููุธุงู ููุนุงูุฌุฉ 76 ููุธูุงู
- ุฏุนู ูุงูู ููุนููุงุช ุงูุณุนูุฏูุฉ (ุฑูุงู ุณุนูุฏู - SR)
- ูุฑููุฉ ูู ุงูุฑุณูู ูุงูุฎุตููุงุช ุงููุฎุตุตุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ:** ููุงูุฑ 2025
**ุงูุฅุตุฏุงุฑ:** 1.0 Beta
**ุงูุญุงูุฉ:** ุฌุงูุฒ ููุฅูุชุงุฌ
