{% extends 'layout.html' %}

{% block extra_css %}
{% include 'attendance/partials/index/_extra_css.html' %}
{% endblock %}

{% block content %}
{% include 'attendance/partials/index/_content.html' %}
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize tooltips
    if (typeof bootstrap !== 'undefined') {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(function(tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    }

    // Date change handler
    const dateInput = document.getElementById('date');
    if (dateInput) {
        dateInput.addEventListener('change', function() {
            const form = this.closest('form');
            if (form) {
                form.submit();
            }
        });
    }
    
    // Set default export dates
    const currentDate = '{{ date.strftime("%Y-%m-%d") if date else "" }}';
    if (currentDate) {
        document.getElementById('export_start_date').value = currentDate;
    } else {
        const today = new Date();
        const formattedDate = today.toISOString().split('T')[0];
        document.getElementById('export_start_date').value = formattedDate;
    }
    
    // Copy selected department to export form
    const selectedDepartment = '{{ selected_department }}';
    if (selectedDepartment) {
        document.getElementById('export_department_id').value = selectedDepartment;
    }


    console.log('تم تحميل صفحة سجل الحضور بنجاح');
});
</script>
{% endblock %}