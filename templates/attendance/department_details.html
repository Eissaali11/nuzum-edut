{% extends 'layout.html' %}

{% block title %}تفاصيل حضور قسم {{ department.name }}{% endblock %}

{% block styles %}
<style>
    .status-present { color: #28a745; }
    .status-absent { color: #dc3545; }
    .status-leave { color: #ffc107; }
    .status-sick { color: #17a2b8; }
    .status-cell {
        text-align: center;
        padding: 8px;
        border-radius: 4px;
        font-weight: bold;
        font-size: 12px;
    }
    .status-present-bg { background-color: #d4edda; }
    .status-absent-bg { background-color: #f8d7da; }
    .status-leave-bg { background-color: #fff3cd; }
    .status-sick-bg { background-color: #d1ecf1; }
    .employee-stats {
        font-size: 11px;
        padding: 2px 6px;
        border-radius: 10px;
        margin: 0 2px;
    }
    .table th {
        position: sticky;
        top: 0;
        background: white;
        z-index: 10;
    }
    .table .employee-name {
        position: sticky;
        right: 0;
        background: white;
        z-index: 5;
        min-width: 200px;
    }
    .date-header {
        writing-mode: vertical-rl;
        text-orientation: mixed;
        min-width: 40px;
        font-size: 11px;
    }
</style>
{% endblock %}

{% block content %}
{% include 'attendance/partials/department_details/_content.html' %}
{% endblock %}

{% block scripts %}
<script>
function exportToExcel() {
    const params = new URLSearchParams(window.location.search);
    const exportUrl = `/attendance/export-department-details?${params.toString()}`;
    window.open(exportUrl, '_blank');
}
</script>
{% endblock %}