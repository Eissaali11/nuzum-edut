{% extends "admin_dashboard/layout.html" %}

{% block title %}الرئيسية - لوحة التحكم الإدارية{% endblock %}
{% block page_title %}الرئيسية{% endblock %}

{% block content %}
{% include 'admin_dashboard/partials/dashboard/_content.html' %}
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // تحديث الإحصائيات كل 30 ثانية
    setInterval(updateStats, 30000);
    
    function updateStats() {
        fetch('{{ url_for("admin_dashboard.api_stats") }}')
            .then(response => response.json())
            .then(data => {
                // تحديث قيم الإحصائيات
                const statsElements = {
                    'employees': document.querySelector('.stats-card:nth-child(1) h3'),
                    'vehicles': document.querySelector('.stats-card:nth-child(2) h3'),
                    'departments': document.querySelector('.stats-card:nth-child(3) h3'),
                    'mobile_devices': document.querySelector('.stats-card:nth-child(4) h3')
                };
                
                Object.keys(statsElements).forEach(key => {
                    if (statsElements[key]) {
                        statsElements[key].textContent = data[key];
                    }
                });
            })
            .catch(error => console.error('Error updating stats:', error));
    }
});
</script>
{% endblock %}