{% extends 'layout.html' %}

{% block title %}إضافة سيارة جديدة{% endblock %}

{% block extra_css %}
{% include 'vehicles/partials/create/_extra_css.html' %}
{% endblock %}

{% block content %}
{% include 'vehicles/partials/create/_content.html' %}
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const driverNameInput = document.getElementById('driver_name');
    const regionInput = document.getElementById('region');
    
    // ملء المنطقة تلقائياً عند تغيير اسم السائق
    driverNameInput.addEventListener('blur', function() {
        const driverName = this.value.trim();
        
        if (driverName) {
            // جلب معلومات الموظف من API
            fetch(`/vehicles/api/get_employee_info/${encodeURIComponent(driverName)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.location) {
                        // ملء حقل المنطقة تلقائياً
                        regionInput.value = data.location;
                        // إضافة تأثير بصري للإشارة إلى التحديث
                        regionInput.classList.add('border-success');
                        setTimeout(() => {
                            regionInput.classList.remove('border-success');
                        }, 2000);
                    }
                })
                .catch(error => {
                    console.error('خطأ في جلب معلومات الموظف:', error);
                });
        }
    });
});
</script>
{% endblock %}