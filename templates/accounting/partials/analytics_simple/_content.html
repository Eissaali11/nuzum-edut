<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-gradient-primary text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-chart-bar me-2"></i>
                        ุงูุชุญููู ุงููุงูู ุงููุจุณุท - ุงูุจูุงูุงุช ุงูุญููููุฉ
                    </h4>
                    <small>ุขุฎุฑ ุชุญุฏูุซ: {{ data.last_updated }}</small>
                </div>
                <div class="card-body">
                    
                    {% if error %}
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        ุชู ุนุฑุถ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ุจุณุจุจ: {{ error }}
                    </div>
                    {% endif %}

                    <!-- ุงูุฅุญุตุงุฆูุงุช ุงูุฃุณุงุณูุฉ -->
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="card bg-gradient-primary text-white">
                                <div class="card-body text-center">
                                    <h5><i class="fas fa-users me-2"></i>ุงูููุธููู</h5>
                                    <h2>{{ data.basic_stats.total_employees }}</h2>
                                    <small>ุฅุฌูุงูู ุงูููุธููู</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card bg-gradient-success text-white">
                                <div class="card-body text-center">
                                    <h5><i class="fas fa-building me-2"></i>ุงูุฃูุณุงู</h5>
                                    <h2>{{ data.basic_stats.total_departments }}</h2>
                                    <small>ุนุฏุฏ ุงูุฃูุณุงู</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card bg-gradient-info text-white">
                                <div class="card-body text-center">
                                    <h5><i class="fas fa-exchange-alt me-2"></i>ุงููุนุงููุงุช</h5>
                                    <h2>{{ data.basic_stats.total_transactions }}</h2>
                                    <small>ุฅุฌูุงูู ุงููุนุงููุงุช</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="card bg-gradient-warning text-white">
                                <div class="card-body text-center">
                                    <h5><i class="fas fa-list me-2"></i>ุงูุญุณุงุจุงุช</h5>
                                    <h2>{{ data.basic_stats.total_accounts }}</h2>
                                    <small>ุฏููู ุงูุญุณุงุจุงุช</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ุงูููุฎุต ุงููุงูู -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="fas fa-dollar-sign me-2"></i>ุงูููุฎุต ุงููุงูู</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="text-center p-3">
                                                <h5>ุฅุฌูุงูู ุงููุจุงูุบ</h5>
                                                <h4 class="text-primary">{{ "{:,.0f}".format(data.financial_summary.total_amount) }} ุฑูุงู</h4>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="text-center p-3">
                                                <h5>ูุฌููุน ุงูุฑูุงุชุจ</h5>
                                                <h4 class="text-success">{{ "{:,.0f}".format(data.financial_summary.total_salaries) }} ุฑูุงู</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="text-center p-3">
                                                <h5>ูุตุงุฑูู ุงููุฑูุจุงุช</h5>
                                                <h4 class="text-warning">{{ "{:,.0f}".format(data.financial_summary.total_vehicle_expenses) }} ุฑูุงู</h4>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="text-center p-3">
                                                <h5>ูุนุงููุงุช ุงูุดูุฑ</h5>
                                                <h4 class="text-info">{{ "{:,.0f}".format(data.financial_summary.monthly_total) }} ุฑูุงู</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="fas fa-chart-pie me-2"></i>ุชูุฒูุน ุงูุญุณุงุจุงุช</h6>
                                </div>
                                <div class="card-body">
                                    <canvas id="accountsChart" width="300" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ุขุฎุฑ ุงููุนุงููุงุช -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="fas fa-history me-2"></i>ุขุฎุฑ ุงููุนุงููุงุช</h6>
                                </div>
                                <div class="card-body">
                                    {% if data.recent_activity %}
                                    <div class="table-responsive">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>ุฑูู ุงููุนุงููุฉ</th>
                                                    <th>ุงูููุน</th>
                                                    <th>ุงููุจูุบ</th>
                                                    <th>ุงูุชุงุฑูุฎ</th>
                                                    <th>ุงููุตู</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for transaction in data.recent_activity %}
                                                <tr>
                                                    <td><strong>#{{ transaction.id }}</strong></td>
                                                    <td>
                                                        <span class="badge bg-secondary">{{ transaction.type }}</span>
                                                    </td>
                                                    <td>{{ "{:,.0f}".format(transaction.amount) }} ุฑูุงู</td>
                                                    <td>{{ transaction.date }}</td>
                                                    <td>{{ transaction.description[:50] }}...</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                    {% else %}
                                    <div class="text-center p-4">
                                        <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                                        <h5>ูุง ุชูุฌุฏ ูุนุงููุงุช ูุณุฌูุฉ</h5>
                                        <p class="text-muted">ุงุจุฏุฃ ุจุฅุถุงูุฉ ุงููุนุงููุงุช ุงููุญุงุณุจูุฉ ูุนุฑุถ ุงูุชุญููู ุงููุงูู</p>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ุฑูุงุจุท ุณุฑูุนุฉ -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="fas fa-link me-2"></i>ุฑูุงุจุท ุณุฑูุนุฉ</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <a href="{{ url_for('accounting.dashboard') }}" class="btn btn-primary w-100 mb-2">
                                                <i class="fas fa-tachometer-alt me-2"></i>ููุญุฉ ุงููุญุงุณุจุฉ
                                            </a>
                                        </div>
                                        <div class="col-md-3">
                                            <a href="{{ url_for('accounting.accounts') }}" class="btn btn-success w-100 mb-2">
                                                <i class="fas fa-list me-2"></i>ุฏููู ุงูุญุณุงุจุงุช
                                            </a>
                                        </div>
                                        <div class="col-md-3">
                                            <a href="{{ url_for('accounting.transactions') }}" class="btn btn-info w-100 mb-2">
                                                <i class="fas fa-exchange-alt me-2"></i>ุงููุนุงููุงุช
                                            </a>
                                        </div>
                                        <div class="col-md-3">
                                            <a href="{{ url_for('accounting_ext.salary_processing') }}" class="btn btn-warning w-100 mb-2">
                                                <i class="fas fa-money-check-alt me-2"></i>ูุนุงูุฌุฉ ุงูุฑูุงุชุจ
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                
                <!-- ูุณู ุงูุชุญููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู -->
                <div class="col-12">
                    <div class="card shadow-lg border-0" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <div class="card-header text-white border-0">
                            <h4 class="card-title mb-0">
                                <i class="fas fa-brain me-2"></i>ุงูุชุญููู ุงููุงูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
                            </h4>
                            <p class="card-text mb-0 opacity-75">ุชุญูููุงุช ูุชูุจุคุงุช ุฐููุฉ ูุฏุนููุฉ ุจู OpenAI GPT-4o</p>
                        </div>
                        <div class="card-body">
                            <!-- ุฃุฒุฑุงุฑ ุงูุชุญููู -->
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <button class="btn btn-light btn-lg w-100 mb-3" onclick="loadAIPredictions()" id="predictionsBtn">
                                        <i class="fas fa-chart-line text-primary me-2"></i>
                                        <div>ุชูุจุคุงุช ูุงููุฉ</div>
                                        <small class="text-muted">ุชููุนุงุช ุงูุฅูุฑุงุฏุงุช ูุงููุตุฑููุงุช</small>
                                    </button>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-light btn-lg w-100 mb-3" onclick="loadPatternAnalysis()" id="patternsBtn">
                                        <i class="fas fa-search text-warning me-2"></i>
                                        <div>ุชุญููู ุงูุฃููุงุท</div>
                                        <small class="text-muted">ุงูุชุดุงู ุงูุดุฐูุฐ ูุงููุฎุงุทุฑ</small>
                                    </button>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-light btn-lg w-100 mb-3" onclick="loadBudgetRecommendations()" id="budgetBtn">
                                        <i class="fas fa-piggy-bank text-success me-2"></i>
                                        <div>ุชูุตูุงุช ุงูููุฒุงููุฉ</div>
                                        <small class="text-muted">ุงูุชุฑุงุญุงุช ูุชุญุณูู ุงูุฃุฏุงุก</small>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- ููุทูุฉ ุนุฑุถ ุงููุชุงุฆุฌ -->
                            <div id="aiResults" class="bg-white rounded p-4" style="min-height: 200px; display: none;">
                                <div id="aiContent">
                                    <!-- ุณูุชู ุชุญููู ุงููุญุชูู ููุง -->
                                </div>
                            </div>
                            
                            <!-- ุญุงูุฉ ุงูุชุญููู -->
                            <div id="aiLoading" class="text-center text-white" style="display: none;">
                                <div class="spinner-border text-light mb-3" role="status">
                                    <span class="visually-hidden">ุฌุงุฑู ุงูุชุญููู...</span>
                                </div>
                                <p class="mb-0">
                                    <i class="fas fa-robot me-2"></i>
                                    ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุญูู ุงูุจูุงูุงุช ุงููุงููุฉ...
                                </p>
                                <small class="opacity-75">ูุฏ ูุณุชุบุฑู ุงูุชุญููู ุจุถุนุฉ ุซูุงูู</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.bg-gradient-primary { background: linear-gradient(45deg, #4e73df, #224abe); }
.bg-gradient-success { background: linear-gradient(45deg, #1cc88a, #13855c); }
.bg-gradient-danger { background: linear-gradient(45deg, #e74a3b, #be2617); }
.bg-gradient-info { background: linear-gradient(45deg, #36b9cc, #258391); }
.bg-gradient-warning { background: linear-gradient(45deg, #f6c23e, #d4a72c); }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// ุฑุณู ุชูุฒูุน ุงูุญุณุงุจุงุช
const ctx = document.getElementById('accountsChart').getContext('2d');
new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: ['ุญุณุงุจุงุช ุงูุฅูุฑุงุฏุงุช', 'ุญุณุงุจุงุช ุงููุตุฑููุงุช', 'ุญุณุงุจุงุช ุฃุฎุฑู'],
        datasets: [{
            data: [
                {{ data.account_breakdown.revenue_accounts }},
                {{ data.account_breakdown.expense_accounts }},
                {{ data.account_breakdown.total_accounts - data.account_breakdown.revenue_accounts - data.account_breakdown.expense_accounts }}
            ],
            backgroundColor: ['#1cc88a', '#e74a3b', '#36b9cc']
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { position: 'bottom' }
        }
    }
});

// ูุธุงุฆู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
function showLoading() {
    document.getElementById('aiResults').style.display = 'none';
    document.getElementById('aiLoading').style.display = 'block';
}

function hideLoading() {
    document.getElementById('aiLoading').style.display = 'none';
    document.getElementById('aiResults').style.display = 'block';
}

function showError(message) {
    hideLoading();
    document.getElementById('aiContent').innerHTML = `
        <div class="alert alert-danger">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <strong>ุฎุทุฃ:</strong> ${message}
        </div>
    `;
}

// ุชูุจุคุงุช ูุงููุฉ
function loadAIPredictions() {
    showLoading();
    
    fetch('/accounting/analytics/api/ai-predictions')
        .then(response => response.json())
        .then(data => {
            hideLoading();
            
            if (data.error) {
                showError(data.error);
                return;
            }
            
            displayPredictions(data);
        })
        .catch(error => {
            console.error('ุฎุทุฃ:', error);
            showError('ูุดู ูู ุงูุงุชุตุงู ุจุงูุฎุฏูุฉ');
        });
}

// ุชุญููู ุงูุฃููุงุท
function loadPatternAnalysis() {
    showLoading();
    
    fetch('/accounting/analytics/api/pattern-analysis')
        .then(response => response.json())
        .then(data => {
            hideLoading();
            
            if (data.error) {
                showError(data.error);
                return;
            }
            
            displayPatternAnalysis(data);
        })
        .catch(error => {
            console.error('ุฎุทุฃ:', error);
            showError('ูุดู ูู ุงูุงุชุตุงู ุจุงูุฎุฏูุฉ');
        });
}

// ุชูุตูุงุช ุงูููุฒุงููุฉ
function loadBudgetRecommendations() {
    showLoading();
    
    fetch('/accounting/analytics/api/budget-recommendations')
        .then(response => response.json())
        .then(data => {
            hideLoading();
            
            if (data.error) {
                showError(data.error);
                return;
            }
            
            displayBudgetRecommendations(data);
        })
        .catch(error => {
            console.error('ุฎุทุฃ:', error);
            showError('ูุดู ูู ุงูุงุชุตุงู ุจุงูุฎุฏูุฉ');
        });
}

// ุนุฑุถ ุงูุชูุจุคุงุช
function displayPredictions(data) {
    const predictions = data.predictions;
    let html = `
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="mb-0">
                <i class="fas fa-chart-line text-primary me-2"></i>
                ุงูุชูุจุคุงุช ุงููุงููุฉ ุงูุฐููุฉ
            </h5>
            <span class="badge bg-primary">${data.model_used || 'ุงูุฐูุงุก ุงูุงุตุทูุงุนู'}</span>
        </div>
    `;
    
    if (predictions) {
        // ุชุญููู ุงูุงุชุฌุงูุงุช
        if (predictions.ุชุญููู_ุงูุงุชุฌุงูุงุช) {
            html += `
                <div class="card border-0 shadow-sm mb-3">
                    <div class="card-header bg-light">
                        <h6 class="mb-0">๐ ุชุญููู ุงูุงุชุฌุงูุงุช ุงููุงููุฉ</h6>
                    </div>
                    <div class="card-body">
                        <p class="text-success mb-2"><strong>ุงูุงุชุฌุงู ุงูุนุงู:</strong> ${predictions.ุชุญููู_ุงูุงุชุฌุงูุงุช.ุงูุงุชุฌุงู_ุงูุนุงู}</p>
                        <p class="mb-2"><strong>ูููู ุงููุตุฑููุงุช:</strong></p>
                        <ul class="list-unstyled ms-3">
                            ${predictions.ุชุญููู_ุงูุงุชุฌุงูุงุช.ุงููุตุฑููุงุช_ุงูุฑุฆูุณูุฉ.map(item => 
                                `<li><span class="badge bg-info me-2">โข</span>${item}</li>`
                            ).join('')}
                        </ul>
                        <div class="alert alert-light border-start border-warning border-4">
                            <small><strong>ุชุทูุฑ ููุญูุธ:</strong> ${predictions.ุชุญููู_ุงูุงุชุฌุงูุงุช.ุงูุชุบูุฑุงุช_ุงูููุญูุธุฉ}</small>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ุงูุชูุจุคุงุช ุงููุงุฏูุฉ
        if (predictions.ุงูุชูุจุคุงุช_ุงููุงุฏูุฉ) {
            html += `
                <div class="card border-0 shadow-sm mb-3">
                    <div class="card-header bg-light">
                        <h6 class="mb-0">๐ฎ ุชููุนุงุช ุงูุฃุดูุฑ ุงููุงุฏูุฉ</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
            `;
            
            Object.entries(predictions.ุงูุชูุจุคุงุช_ุงููุงุฏูุฉ).forEach(([period, forecast]) => {
                html += `
                    <div class="col-md-6 mb-3">
                        <div class="border rounded p-3 bg-light">
                            <h6 class="text-primary">${period.replace('_', ' ')}</h6>
                            <div class="d-flex justify-content-between">
                                <span>ุงููุตุฑููุงุช:</span>
                                <strong class="text-danger">${forecast.ุงููุตุฑููุงุช_ุงููุชููุนุฉ}</strong>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>ุงูุฅูุฑุงุฏุงุช:</span>
                                <strong class="text-success">${forecast.ุงูุฅูุฑุงุฏุงุช_ุงููุชููุนุฉ}</strong>
                            </div>
                            <hr class="my-2">
                            <div class="d-flex justify-content-between">
                                <span><strong>ุงูุฑุจุญ ุงููุชููุน:</strong></span>
                                <strong class="text-primary">${forecast.ุงูุฑุจุญ_ุงููุชููุน}</strong>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ุงููุฎุงุทุฑ ูุงูุชูุตูุงุช
        if (predictions.ุงููุฎุงุทุฑ_ุงููุญุชููุฉ || predictions.ุงูุชูุตูุงุช) {
            html += `
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-header bg-warning bg-opacity-10">
                                <h6 class="mb-0 text-warning">โ๏ธ ุงููุฎุงุทุฑ ุงููุญุชููุฉ</h6>
                            </div>
                            <div class="card-body">
                                <ul class="list-unstyled">
                                    ${predictions.ุงููุฎุงุทุฑ_ุงููุญุชููุฉ ? predictions.ุงููุฎุงุทุฑ_ุงููุญุชููุฉ.map(risk => 
                                        `<li class="mb-2"><span class="text-warning">โฒ</span> ${risk}</li>`
                                    ).join('') : '<li>ูุง ุชูุฌุฏ ูุฎุงุทุฑ ูุญุฏุฏุฉ</li>'}
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-header bg-success bg-opacity-10">
                                <h6 class="mb-0 text-success">๐ก ุงูุชูุตูุงุช</h6>
                            </div>
                            <div class="card-body">
                                <ul class="list-unstyled">
                                    ${predictions.ุงูุชูุตูุงุช ? predictions.ุงูุชูุตูุงุช.map(rec => 
                                        `<li class="mb-2"><span class="text-success">โ</span> ${rec}</li>`
                                    ).join('') : '<li>ูุง ุชูุฌุฏ ุชูุตูุงุช ุญุงููุฉ</li>'}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
    }
    
    // ุฅุถุงูุฉ ููุงุญุธุฉ ูู ุงูููุงูุฉ
    if (data.note) {
        html += `
            <div class="alert alert-info border-start border-info border-4 mt-3">
                <small><i class="fas fa-info-circle me-1"></i> ${data.note}</small>
            </div>
        `;
    }
    
    document.getElementById('aiContent').innerHTML = html;
}

// ุนุฑุถ ุชุญููู ุงูุฃููุงุท
function displayPatternAnalysis(data) {
    let html = `
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="mb-0">
                <i class="fas fa-search text-warning me-2"></i>
                ุชุญููู ุฃููุงุท ุงููุนุงููุงุช
            </h5>
            <span class="badge bg-warning">ุชุญููู ุงูุฃููุงุท</span>
        </div>
    `;
    
    // ุงูุฃููุงุท ุงูุทุจูุนูุฉ
    if (data.ุงูุฃููุงุท_ุงูุทุจูุนูุฉ) {
        html += `
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-header bg-success bg-opacity-10">
                    <h6 class="mb-0 text-success">โ ุงูุฃููุงุท ุงูุทุจูุนูุฉ</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p class="mb-2"><strong>ุฃูุงู ุงููุดุงุท ุงูุนุงูู:</strong></p>
                            <p class="text-muted ms-3">${data.ุงูุฃููุงุท_ุงูุทุจูุนูุฉ.ุฃูุงู_ุงููุดุงุท_ุงูุนุงูู.join(', ')}</p>
                            
                            <p class="mb-2"><strong>ูุชูุณุท ุงููุนุงููุงุช ุงูููููุฉ:</strong></p>
                            <p class="text-primary ms-3">${data.ุงูุฃููุงุท_ุงูุทุจูุนูุฉ.ูุชูุณุท_ุงููุนุงููุงุช_ุงูููููุฉ}</p>
                        </div>
                        <div class="col-md-6">
                            <p class="mb-2"><strong>ุฃููุงุช ุงูุฐุฑูุฉ:</strong></p>
                            <ul class="list-unstyled ms-3">
                                ${data.ุงูุฃููุงุท_ุงูุทุจูุนูุฉ.ุฃููุงุช_ุงูุฐุฑูุฉ.map(time => 
                                    `<li><span class="badge bg-light text-dark me-2">โฐ</span>${time}</li>`
                                ).join('')}
                            </ul>
                            
                            <p class="mb-2"><strong>ูุชูุณุท ูููุฉ ุงููุนุงููุฉ:</strong></p>
                            <p class="text-success ms-3 fs-5"><strong>${data.ุงูุฃููุงุท_ุงูุทุจูุนูุฉ.ูุชูุณุท_ูููุฉ_ุงููุนุงููุฉ}</strong></p>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }
    
    // ุงููุนุงููุงุช ุบูุฑ ุงูุทุจูุนูุฉ
    if (data.ุงููุนุงููุงุช_ุบูุฑ_ุงูุทุจูุนูุฉ) {
        html += `
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-header bg-warning bg-opacity-10">
                    <h6 class="mb-0 text-warning">โ๏ธ ุงููุนุงููุงุช ุบูุฑ ุงูุทุจูุนูุฉ</h6>
                </div>
                <div class="card-body">
        `;
        
        Object.entries(data.ุงููุนุงููุงุช_ุบูุฑ_ุงูุทุจูุนูุฉ).forEach(([key, value]) => {
            const title = key.replace(/_/g, ' ');
            const icon = key.includes('ูุจูุฑุฉ') ? '๐ฐ' : key.includes('ุฃููุงุช') ? '๐' : '๐';
            html += `
                <div class="alert alert-warning border-start border-warning border-4 mb-2">
                    <strong>${icon} ${title}:</strong><br>
                    <small>${value}</small>
                </div>
            `;
        });
        
        html += `
                </div>
            </div>
        `;
    }
    
    // ุงุชุฌุงูุงุช ุงูุฅููุงู
    if (data.ุงุชุฌุงูุงุช_ุงูุฅููุงู) {
        html += `
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-header bg-info bg-opacity-10">
                    <h6 class="mb-0 text-info">๐ ุงุชุฌุงูุงุช ุงูุฅููุงู ุงูููููุฉ</h6>
                </div>
                <div class="card-body">
                    <div class="row">
        `;
        
        Object.entries(data.ุงุชุฌุงูุงุช_ุงูุฅููุงู).forEach(([day, pattern]) => {
            html += `
                <div class="col-md-6 col-lg-4 mb-3">
                    <div class="border rounded p-3 h-100">
                        <h6 class="text-primary">${day}</h6>
                        <p class="text-muted small mb-0">${pattern}</p>
                    </div>
                </div>
            `;
        });
        
        html += `
                    </div>
                </div>
            </div>
        `;
    }
    
    // ุชูุตูุงุช ุงูุฑูุงุจุฉ
    if (data.ุชูุตูุงุช_ุงูุฑูุงุจุฉ) {
        html += `
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-header bg-primary bg-opacity-10">
                    <h6 class="mb-0 text-primary">๐ก๏ธ ุชูุตูุงุช ุชุญุณูู ุงูุฑูุงุจุฉ ุงููุงููุฉ</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        ${data.ุชูุตูุงุช_ุงูุฑูุงุจุฉ.map((recommendation, index) => `
                            <div class="col-md-6 mb-3">
                                <div class="d-flex align-items-start">
                                    <span class="badge bg-primary rounded-pill me-3">${index + 1}</span>
                                    <p class="mb-0">${recommendation}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }
    
    // ููุงุญุธุฉ
    if (data.note) {
        html += `
            <div class="alert alert-info border-start border-info border-4">
                <small><i class="fas fa-info-circle me-1"></i> ${data.note}</small>
            </div>
        `;
    }
    
    document.getElementById('aiContent').innerHTML = html;
}

// ุนุฑุถ ุชูุตูุงุช ุงูููุฒุงููุฉ
function displayBudgetRecommendations(data) {
    let html = `
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="mb-0">
                <i class="fas fa-piggy-bank text-success me-2"></i>
                ุชูุตูุงุช ุงูููุฒุงููุฉ ุงูุฐููุฉ
            </h5>
            <span class="badge bg-success">ุชุญุณูู ุงูุฃุฏุงุก</span>
        </div>
    `;
    
    // ุชุญููู ูููู ุงููุตุฑููุงุช
    if (data.ุชุญููู_ูููู_ุงููุตุฑููุงุช) {
        html += `
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-primary bg-opacity-10">
                    <h6 class="mb-0 text-primary">๐ ุชุญููู ูููู ุงููุตุฑููุงุช</h6>
                </div>
                <div class="card-body">
                    <div class="row">
        `;
        
        Object.entries(data.ุชุญููู_ูููู_ุงููุตุฑููุงุช).forEach(([category, details]) => {
            const title = category.replace(/_/g, ' ');
            html += `
                <div class="col-md-6 mb-3">
                    <div class="border rounded p-3 h-100">
                        <h6 class="text-dark">${title}</h6>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span>ุงููุณุจุฉ:</span>
                            <span class="badge bg-info">${details.ุงููุณุจุฉ}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span>ุงููุจูุบ ุงูุดูุฑู:</span>
                            <strong class="text-primary">${details.ุงููุจูุบ_ุงูุดูุฑู}</strong>
                        </div>
                        <div class="alert alert-light border-0 mb-0">
                            <small><strong>ุงูุชูููู:</strong> ${details.ุงูุชูููู}</small>
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += `
                    </div>
                </div>
            </div>
        `;
    }
    
    // ูุฑุต ุงูุชูููุฑ
    if (data.ูุฑุต_ุงูุชูููุฑ) {
        html += `
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-success bg-opacity-10">
                    <h6 class="mb-0 text-success">๐ฐ ูุฑุต ุงูุชูููุฑ ุงููุญุฏุฏุฉ</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        ${data.ูุฑุต_ุงูุชูููุฑ.map((opportunity, index) => `
                            <div class="col-md-4 mb-3">
                                <div class="card border-success h-100">
                                    <div class="card-body text-center">
                                        <h6 class="card-title text-success">${opportunity.ุงููุฌุงู}</h6>
                                        <div class="display-6 text-success mb-2">
                                            ${opportunity.ุงูุชูููุฑ_ุงููุชููุน}
                                        </div>
                                        <p class="card-text small text-muted">${opportunity.ุงูุทุฑููุฉ}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }
    
    // ุงูุชุฑุงุญ ุงูููุฒุงููุฉ
    if (data.ุงูุชุฑุงุญ_ุงูููุฒุงููุฉ) {
        html += `
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-warning bg-opacity-10">
                    <h6 class="mb-0 text-warning">๐ ุงูุชุฑุงุญ ุงูููุฒุงููุฉ ุงููุญุณูุฉ</h6>
                </div>
                <div class="card-body">
        `;
        
        Object.entries(data.ุงูุชุฑุงุญ_ุงูููุฒุงููุฉ).forEach(([period, budget]) => {
            html += `
                <h6 class="text-primary mb-3">${period.replace(/_/g, ' ')}</h6>
                <div class="row">
            `;
            
            Object.entries(budget).forEach(([item, amount]) => {
                const isTotal = item === 'ุงูุฅุฌูุงูู';
                const isSaving = item === 'ุงูุชูููุฑ_ุงูููู';
                const itemName = item.replace(/_/g, ' ');
                const colorClass = isTotal ? 'text-primary' : isSaving ? 'text-success' : 'text-dark';
                
                html += `
                    <div class="col-md-3 mb-2">
                        <div class="d-flex justify-content-between ${isTotal || isSaving ? 'border-top pt-2' : ''}">
                            <span class="${colorClass}">${itemName}:</span>
                            <strong class="${colorClass}">${amount}</strong>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
        });
        
        html += `
                </div>
            </div>
        `;
    }
    
    // ุขููุฉ ุงููุฑุงูุจุฉ ูุงููุคุดุฑุงุช
    html += `
        <div class="row">
            <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-info bg-opacity-10">
                        <h6 class="mb-0 text-info">๐ ุขููุฉ ุงููุฑุงูุจุฉ</h6>
                    </div>
                    <div class="card-body">
    `;
    
    if (data.ุขููุฉ_ุงููุฑุงูุจุฉ) {
        Object.entries(data.ุขููุฉ_ุงููุฑุงูุจุฉ).forEach(([method, description]) => {
            const methodName = method.replace(/_/g, ' ');
            html += `
                <div class="mb-3">
                    <strong class="text-info">${methodName}:</strong>
                    <br><small class="text-muted">${description}</small>
                </div>
            `;
        });
    }
    
    html += `
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-danger bg-opacity-10">
                        <h6 class="mb-0 text-danger">โ๏ธ ุงููุคุดุฑุงุช ุงูุชุญุฐูุฑูุฉ</h6>
                    </div>
                    <div class="card-body">
    `;
    
    if (data.ุงููุคุดุฑุงุช_ุงูุชุญุฐูุฑูุฉ) {
        data.ุงููุคุดุฑุงุช_ุงูุชุญุฐูุฑูุฉ.forEach((indicator, index) => {
            html += `
                <div class="alert alert-danger border-start border-danger border-4 mb-2">
                    <small><strong>${index + 1}.</strong> ${indicator}</small>
                </div>
            `;
        });
    }
    
    html += `
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // ููุงุญุธุฉ
    if (data.note) {
        html += `
            <div class="alert alert-info border-start border-info border-4 mt-3">
                <small><i class="fas fa-info-circle me-1"></i> ${data.note}</small>
            </div>
        `;
    }
    
    document.getElementById('aiContent').innerHTML = html;
}
</script>
