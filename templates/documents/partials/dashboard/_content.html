<div class="dashboard-container">
    <div class="dashboard-content">
        <!-- HEADER -->
        <div class="dashboard-header">
            <div class="header-top">
                <div class="header-text">
                    <h1>
                        <i class="fas fa-file-shield me-3"></i>إدارة الوثائق
                    </h1>
                    <p>نظرة عامة شاملة على جميع الوثائق والصلاحيات</p>
                </div>
                <div class="header-icon">
                    <i class="fas fa-file-contract"></i>
                </div>
            </div>
        </div>

        <!-- STATS GRID -->
        <div class="stats-grid">
            <!-- Total Documents -->
            <div class="stat-card total">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <div class="stat-content">
                        <h3>إجمالي الوثائق</h3>
                        <div class="stat-value">{{ total_documents }}</div>
                    </div>
                </div>
            </div>

            <!-- Expired Documents -->
            <div class="stat-card expired">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3>وثائق منتهية</h3>
                        <div class="stat-value">{{ expired_documents }}</div>
                    </div>
                </div>
            </div>

            <!-- Expiring Soon -->
            <div class="stat-card warning">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3>قريبة من الانتهاء</h3>
                        <div class="stat-value">{{ expiring_soon + expiring_later }}</div>
                    </div>
                </div>
            </div>

            <!-- Valid Documents -->
            <div class="stat-card valid">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3>وثائق سارية</h3>
                        <div class="stat-value">{{ valid_documents }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CHART -->
        <div class="chart-section">
            <div class="chart-header">
                <div class="chart-icon">
                    <i class="fas fa-chart-doughnut"></i>
                </div>
                <h2>توزيع الوثائق حسب الحالة</h2>
            </div>
            <div class="chart-container">
                <canvas id="statusChart"></canvas>
            </div>
        </div>

        <!-- DOCUMENTS SECTIONS -->
        <div class="documents-sections">
            {% if expired_docs %}
            <div class="documents-section section-expired">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <span>وثائق منتهية الصلاحية</span>
                    </div>
                    <a href="{{ url_for('documents.index', expiring='expired') }}" class="view-all-btn">
                        <span>عرض الكل</span>
                        <i class="fas fa-arrow-left"></i>
                    </a>
                </div>

                {% for doc in expired_docs %}
                {% set employee = doc.employee %}
                <div class="document-item expired">
                    <div class="doc-icon">
                        <i class="fas fa-file"></i>
                    </div>
                    <div class="doc-content">
                        <div class="doc-header">
                            <div class="doc-name">{{ employee.name if employee else 'غير محدد' }}</div>
                            <div class="doc-type">{{ doc.document_type }}</div>
                        </div>
                        <div class="doc-expiry">
                            <i class="fas fa-calendar-times"></i>
                            <span>انتهت منذ <strong>{{ (current_date - doc.expiry_date).days if doc.expiry_date else 0 }}</strong> يوم</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            {% if expiring_docs %}
            <div class="documents-section section-warning">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-hourglass-end"></i>
                        </div>
                        <span>وثائق قريبة من الانتهاء</span>
                    </div>
                    <a href="{{ url_for('documents.index', expiring='soon') }}" class="view-all-btn">
                        <span>عرض الكل</span>
                        <i class="fas fa-arrow-left"></i>
                    </a>
                </div>

                {% for doc in expiring_docs %}
                {% set employee = doc.employee %}
                <div class="document-item warning">
                    <div class="doc-icon">
                        <i class="fas fa-file"></i>
                    </div>
                    <div class="doc-content">
                        <div class="doc-header">
                            <div class="doc-name">{{ employee.name if employee else 'غير محدد' }}</div>
                            <div class="doc-type">{{ doc.document_type }}</div>
                        </div>
                        <div class="doc-expiry">
                            <i class="fas fa-hourglass-half"></i>
                            <span>متبقي <strong>{{ (doc.expiry_date - current_date).days if doc.expiry_date else 0 }}</strong> يوم</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            {% if not expired_docs and not expiring_docs %}
            <div class="documents-section">
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <h3>جميع الوثائق سارية المفعول! ✨</h3>
                    <p>لا توجد وثائق منتهية أو قريبة من الانتهاء</p>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
