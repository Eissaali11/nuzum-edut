{% extends 'layout.html' %}

{% block content %}
{% include 'departments/partials/import_employees/_content.html' %}
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // File validation
        document.getElementById('importForm').addEventListener('submit', function(e) {
            const fileInput = document.getElementById('file');
            if (!fileInput.files.length) {
                e.preventDefault();
                alert('الرجاء اختيار ملف Excel');
                return false;
            }
            
            const fileName = fileInput.files[0].name;
            if (!fileName.endsWith('.xlsx') && !fileName.endsWith('.xls')) {
                e.preventDefault();
                alert('الرجاء اختيار ملف Excel صالح (.xlsx, .xls)');
                return false;
            }
        });
    });
    
    function validateExcelFile(input) {
        const fileName = input.value;
        if (fileName && !(fileName.endsWith('.xlsx') || fileName.endsWith('.xls'))) {
            alert('الرجاء اختيار ملف Excel صالح (.xlsx, .xls)');
            input.value = '';
        }
    }
</script>
{% endblock %}