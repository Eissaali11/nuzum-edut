{% extends "layout.html" %}

{% block title %}إدارة المستخدمين{% endblock %}

{% block extra_css %}
{% include 'users/partials/index/_extra_css.html' %}
{% endblock %}

{% block content %}
{% include 'users/partials/index/_content.html' %}
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle department assignment forms
    const permissionForms = document.querySelectorAll('form[action*="/assign_departments/"]');

    permissionForms.forEach(form => {
        form.addEventListener('submit', function(e) {
            const submitButton = form.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.innerHTML = `
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                    جاري الحفظ...
                `;
            }
        });
    });

    // Fix dropdown z-index issues
    document.querySelectorAll('.dropdown').forEach(dropdown => {
        dropdown.addEventListener('shown.bs.dropdown', function() {
            const dropdownMenu = this.querySelector('.dropdown-menu');
            if (dropdownMenu) {
                dropdownMenu.style.zIndex = '1080';
            }
        });
    });
});
</script>
{% endblock %}