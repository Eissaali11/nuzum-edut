<script src="{{ url_for('static', filename='js/image-compression.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // عرض اسم الملف المختار
    const fileInput = document.getElementById('document_file');
    const fileNameDisplay = document.getElementById('file-name-display');
    
    if (fileInput && fileNameDisplay) {
        fileInput.addEventListener('change', function(e) {
            if (fileInput.files.length > 0) {
                fileNameDisplay.textContent = fileInput.files[0].name;
            } else {
                fileNameDisplay.textContent = 'لم يتم اختيار ملف';
            }
        });
    }
    
    // تطبيق ضغط الصور على حقول رفع الملفات
    applyImageCompression('input[type="file"]', {
        maxWidth: 1200,
        maxHeight: 1200,
        quality: 0.85,
        maxFileSize: 3 * 1024 * 1024, // 3MB للوثائق
        outputFormat: 'image/jpeg'
    });
    
    // تحسين تجربة إرسال النموذج
    const form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function(e) {
            const submitButton = document.querySelector('button[type="submit"]');
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="
                            width: 16px;
                            height: 16px;
                            border: 2px solid transparent;
                            border-top: 2px solid white;
                            border-radius: 50%;
                            animation: spin 1s linear infinite;
                        "></div>
                        <i class="fas fa-save"></i> جاري الحفظ...
                    </div>
                `;
            }
        });
    }
});
</script>
