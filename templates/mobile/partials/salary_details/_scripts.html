<script>
function shareSalaryWhatsApp(salaryId, employeeName, year, month, basicSalary, allowances, deductions, netSalary, paymentStatus) {
    // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ù…ÙØµÙ„Ø© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø§ØªØ¨
    const monthNames = {
        '01': 'ÙŠÙ†Ø§ÙŠØ±', '02': 'ÙØ¨Ø±Ø§ÙŠØ±', '03': 'Ù…Ø§Ø±Ø³', '04': 'Ø£Ø¨Ø±ÙŠÙ„',
        '05': 'Ù…Ø§ÙŠÙˆ', '06': 'ÙŠÙˆÙ†ÙŠÙˆ', '07': 'ÙŠÙˆÙ„ÙŠÙˆ', '08': 'Ø£ØºØ³Ø·Ø³',
        '09': 'Ø³Ø¨ØªÙ…Ø¨Ø±', '10': 'Ø£ÙƒØªÙˆØ¨Ø±', '11': 'Ù†ÙˆÙÙ…Ø¨Ø±', '12': 'Ø¯ÙŠØ³Ù…Ø¨Ø±'
    };
    
    const currentDate = new Date();
    const hijriDate = currentDate.toLocaleDateString('ar-SA-u-ca-islamic');
    
    const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹

ğŸ“Š *Ø¥Ø´Ø¹Ø§Ø± Ø±Ø§ØªØ¨ - Ù†ÙØ¸Ù…*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ‘¤ *Ø§Ù„Ù…ÙˆØ¸Ù:* ${employeeName}
ğŸ“… *Ø§Ù„Ø´Ù‡Ø±:* ${monthNames[month]} ${year}
ğŸ“‹ *Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹:* ${paymentStatus}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’° *ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø§ØªØ¨:*

ğŸ’µ Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${basicSalary} Ø±ÙŠØ§Ù„
â• Ø§Ù„Ø¨Ø¯Ù„Ø§Øª: ${allowances} Ø±ÙŠØ§Ù„
â– Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª: ${deductions} Ø±ÙŠØ§Ù„

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… *ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨: ${netSalary} Ø±ÙŠØ§Ù„*

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“± Ù†ÙØ¸Ù… - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±: ${currentDate.toLocaleDateString('ar')}
ğŸŒ™ ${hijriDate}`;

    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Web Share API Ø£ÙˆÙ„Ø§Ù‹
    if (navigator.share) {
        navigator.share({
            title: `Ø¥Ø´Ø¹Ø§Ø± Ø±Ø§ØªØ¨ - ${employeeName}`,
            text: message
        }).catch(err => {
            console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:', err);
            fallbackShare(message);
        });
    } else {
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Web Share API Ù…ØªØ§Ø­Ø§Ù‹
        const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
        window.open(whatsappUrl, '_blank');
    }
}

function fallbackShare(message) {
    // Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø© ÙƒØ¨Ø¯ÙŠÙ„
    if (navigator.clipboard) {
        navigator.clipboard.writeText(message).then(() => {
            alert('ØªÙ… Ù†Ø³Ø® ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø§ØªØ¨ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù„ØµÙ‚Ù‡Ø§ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨.');
        }).catch(() => {
            showShareModal(message);
        });
    } else {
        showShareModal(message);
    }
}

function showShareModal(message) {
    // Ø¥Ù†Ø´Ø§Ø¡ modal Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
        background: rgba(0,0,0,0.8); z-index: 9999; display: flex; 
        align-items: center; justify-content: center; padding: 20px;
    `;
    
    const content = document.createElement('div');
    content.style.cssText = `
        background: white; padding: 20px; border-radius: 10px; 
        max-width: 90%; max-height: 80%; overflow-y: auto; direction: rtl;
    `;
    
    content.innerHTML = `
        <h4 style="margin-bottom: 15px; color: #25D366;">
            <i class="fab fa-whatsapp"></i> Ù…Ø´Ø§Ø±ÙƒØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø§ØªØ¨
        </h4>
        <textarea readonly style="width: 100%; height: 300px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; font-size: 14px; direction: rtl;">${message}</textarea>
        <div style="margin-top: 15px; text-align: center;">
            <button onclick="window.open('https://wa.me/?text=${encodeURIComponent(message)}', '_blank')" 
                    style="background: #25D366; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin-left: 10px; cursor: pointer;">
                <i class="fab fa-whatsapp"></i> ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨
            </button>
            <button onclick="this.closest('.modal-overlay').remove()" 
                    style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                Ø¥ØºÙ„Ø§Ù‚
            </button>
        </div>
    `;
    
    modal.className = 'modal-overlay';
    modal.appendChild(content);
    modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
    document.body.appendChild(modal);
}
</script>
